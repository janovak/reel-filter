# Reel-Filter - Movie Content-Aware Search

A web application that enables users to search and filter movies based on both traditional criteria (genre, ratings, year, awards) and granular content tolerance thresholds (sex/nudity, violence/gore, language/profanity on a 0-10 scale).

## ğŸ¯ Current Status: MVP Complete

**Phase 1-3 Complete** - Core content filtering feature is fully functional!

### What's Working
- âœ… Content tolerance threshold filtering (0-10 scale for sex, violence, language)
- âœ… Color-coded content badges (green=safe, red=exceeds threshold)
- âœ… Movie search with pagination
- âœ… Session-based filter persistence
- âœ… Responsive UI with Tailwind CSS
- âœ… FastAPI backend with PostgreSQL
- âœ… React 18+ TypeScript frontend

### MVP Features
Users can:
1. Set personal content tolerance thresholds
2. Search movies that match their comfort levels
3. See visual indicators (color-coded badges) for content levels
4. Browse results with pagination (20-30 movies per page)
5. Have filters persist during their session

---

## ğŸš€ Quick Start

### Prerequisites
- Python 3.11+
- Node.js 18+
- Docker & Docker Compose (for database)
- OMDb API key (get free at http://www.omdbapi.com/)

### 1. Clone and Setup

```bash
git clone <repository-url>
cd reel-filter
```

### 2. Backend Setup

```bash
# Create virtual environment
cd backend
python -m venv venv

# Activate (Windows)
.\venv\Scripts\activate
# Activate (Linux/Mac)
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Configure environment
cp .env.example .env
# Edit .env and add your OMDb API key
```

### 3. Frontend Setup

```bash
cd frontend
npm install

# Configure environment
cp .env.example .env
# Defaults should work for local development
```

### 4. Database Setup

```bash
# Start PostgreSQL and Redis
docker-compose up -d db redis

# Wait for database to be ready
docker-compose ps

# Run migrations
cd backend
alembic upgrade head
```

### 5. Seed Test Data (Optional)

```bash
# Create seed script (see backend/scripts/seed_test_data.py)
cd backend
python scripts/seed_test_data.py
```

### 6. Start Services

**Terminal 1 - Backend:**
```bash
cd backend
python src/main.py
# API available at http://localhost:8000
# API docs at http://localhost:8000/docs
```

**Terminal 2 - Frontend:**
```bash
cd frontend
npm run dev
# App available at http://localhost:3000
```

### 7. Test the Application

1. Open http://localhost:3000
2. Set content thresholds using the sliders
3. Search for movies (once you have seed data)
4. See color-coded badges indicating content levels

---

## ğŸ“ Project Structure

```
reel-filter/
â”œâ”€â”€ backend/                 # Python FastAPI backend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/            # API routes and schemas
â”‚   â”‚   â”œâ”€â”€ database/       # Database connection and models
â”‚   â”‚   â”œâ”€â”€ models/         # SQLAlchemy ORM models
â”‚   â”‚   â”œâ”€â”€ services/       # Business logic
â”‚   â”‚   â””â”€â”€ main.py         # FastAPI app entry point
â”‚   â”œâ”€â”€ alembic/            # Database migrations
â”‚   â”œâ”€â”€ requirements.txt    # Python dependencies
â”‚   â””â”€â”€ pyproject.toml      # Python project config
â”œâ”€â”€ frontend/               # React TypeScript frontend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # Reusable UI components
â”‚   â”‚   â”œâ”€â”€ pages/          # Page components
â”‚   â”‚   â”œâ”€â”€ services/       # API client
â”‚   â”‚   â”œâ”€â”€ hooks/          # Custom React hooks
â”‚   â”‚   â”œâ”€â”€ types/          # TypeScript type definitions
â”‚   â”‚   â””â”€â”€ styles/         # Tailwind CSS
â”‚   â”œâ”€â”€ package.json        # Node dependencies
â”‚   â””â”€â”€ vite.config.ts      # Vite bundler config
â”œâ”€â”€ shared/
â”‚   â””â”€â”€ contracts/          # API contracts (OpenAPI)
â”œâ”€â”€ specs/                  # Feature specifications
â””â”€â”€ docker-compose.yml      # Docker services config
```

---

## ğŸ”§ Technology Stack

### Backend
- **Framework:** FastAPI 0.109+
- **Database:** PostgreSQL 15+ with SQLAlchemy 2.0+
- **Task Queue:** Celery + Redis
- **Web Scraping:** BeautifulSoup4 + lxml
- **Fuzzy Matching:** RapidFuzz
- **Testing:** pytest, responses, httpx-mock

### Frontend
- **Framework:** React 18.2+ with TypeScript
- **Routing:** React Router 6+
- **Styling:** Tailwind CSS 3+
- **HTTP Client:** Axios
- **Build Tool:** Vite 5+
- **Testing:** Vitest, React Testing Library, Playwright

### Infrastructure
- **Containerization:** Docker & Docker Compose
- **Database Migrations:** Alembic
- **API Documentation:** OpenAPI 3.0 (auto-generated by FastAPI)

---

## ğŸ“Š Database Schema

### Movies Table
- Comprehensive metadata (title, year, genre, ratings, awards)
- Poster URLs, plot summaries, cast information
- Multiple rating sources (IMDb, Rotten Tomatoes, Metacritic)
- Full-text search indexes on title
- Array indexes on genres

### Content Scores Table
- 0-10 scale ratings for three categories:
  - Sex/Nudity
  - Violence/Gore
  - Language/Profanity
- Source tracking (Kids-in-Mind)
- Fuzzy matching confidence scores
- Composite indexes for fast filtering

### Data Refresh Logs Table
- Operational tracking for weekly data refresh
- Error logging and performance metrics
- Success/failure status

---

## ğŸ¨ UI Components

### ContentBadge
- Color-coded badges (green/red/gray)
- Shows content score vs. user threshold
- Used throughout the application

### FilterPanel
- Content threshold sliders (0-10)
- "Show all" checkboxes for "any" threshold
- Reset button
- Session persistence

### MovieCard
- Movie poster with lazy loading
- Title, year, MPAA rating
- Multiple ratings display
- Content badges with threshold comparison
- Hover effects

### SearchPage
- Search bar for title search
- Sidebar with FilterPanel
- Results grid (responsive)
- Pagination controls
- Loading/error/empty states

---

## ğŸ” Environment Variables

### Backend (.env)
```env
DATABASE_URL=postgresql://user:password@localhost:5432/reel_filter
REDIS_URL=redis://localhost:6379/0
OMDB_API_KEY=your_api_key_here
CORS_ORIGINS=http://localhost:3000
DEBUG=true
```

### Frontend (.env)
```env
VITE_API_BASE_URL=http://localhost:8000/api
VITE_ENVIRONMENT=development
```

---

## ğŸ“ API Endpoints

### Movies
- `GET /api/movies/search` - Search and filter movies
  - Query params: q, genres, year_min/max, ratings, content thresholds
  - Returns: Paginated movie list with content scores
- `GET /api/movies/{id}` - Get single movie details

### Metadata (Coming Soon)
- `GET /api/genres` - Get list of available genres

### Health (Coming Soon)
- `GET /api/health` - Health check with database status

---

## ğŸ§ª Testing

### Backend
```bash
cd backend
pytest tests/ -v --cov=src
```

### Frontend
```bash
cd frontend
npm test                # Unit tests
npm run test:ui         # Test UI
npm run test:e2e        # End-to-end tests
```

---

## ğŸ“… Development Roadmap

### âœ… Phase 1: Setup (Complete)
- Project structure, dependencies, Docker

### âœ… Phase 2: Foundational (Complete)
- Database models, API foundation, React setup

### âœ… Phase 3: User Story 1 - MVP (Complete)
- Content-filtered movie browsing
- Core differentiator feature

### ğŸ”„ Phase 4: User Story 2 (Planned)
- Traditional search and discovery
- Genre/year/rating filters

### ğŸ”„ Phase 5: User Story 3 (Planned)
- Detailed movie information pages

### ğŸ”„ Phase 6: User Story 4 (Planned)
- Mobile-responsive experience

### ğŸ”„ Phase 7: Data Integration (Planned)
- OMDb API integration
- Kids-in-Mind web scraping
- Weekly automated refresh

### ğŸ”„ Phase 8: Health & Monitoring (Planned)
- Health check endpoints
- Performance logging

### ğŸ”„ Phase 9: Polish (Planned)
- Error boundaries, loading spinners
- Performance optimization
- Documentation

---

## ğŸ¤ Contributing

This project is currently in MVP development phase. Contributions welcome after initial release!

---

## ğŸ“„ License

[Your License Here]

---

## ğŸ™ Acknowledgments

- OMDb API for movie metadata
- Kids-in-Mind for content ratings
- The FastAPI and React communities

---

## ğŸ“ Support

For issues, questions, or feature requests, please open an issue on GitHub.

---

**Last Updated:** 2025-01-23
**Version:** 1.0.0-MVP
**Status:** Core content filtering feature complete and ready for testing
